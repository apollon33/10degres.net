<p>Reported by <a href="http://blog.sucuri.net/2014/12/critical-vulnerability-in-joomla-hd-flv-player-plugin.html" title="Sucuri" class="flashlink" target="_blank">Sucuri</a>, 
the HD FLV Player suffers of an Arbitrary File Download vulnerability which is of course considered critical.</p>

<p>The vulnerable code can be found in <code class="highlighter-rouge">download.php</code>:</p>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'f'</span><span class="p">];</span>
<span class="nb">header</span><span class="p">(</span><span class="s1">'Content-disposition: attachment; filename='</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
<span class="nb">readfile</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
</div>

<p>Since there is absolutly no check nor filter applied before using the <code class="highlighter-rouge">f</code> parameter passed in the url, this is the perfect backdoor to get almost any file you want on the machine 
(depending of the right of the user the server is running). No matter the plugin is enable or not, you simply need to run the install to be exposed.</p>

<!--more-->

<p>Here is a POC on my local Wordpress (same result might append with Joomla):</p>

<p><a href="/images/hd_flv_player_wordpress_poc.png"><img src="/images/hd_flv_player_wordpress_poc.png" alt="hd flv player wordpress poc" /></a></p>

<p>The wierd thing is that the Wordpress and Joomla plugins have been patched but <strong>not the archive</strong> on 
<a href="http://www.hdflvplayer.net/hd-flv-player-download.php" title="HD FLV Player" class="flashlink" target="_blank">HD FLV Player official website</a>, leaving custom installations vulnerable.</p>

<p>Note: As Sucuri said, <code class="highlighter-rouge">email.php</code> should be considered too but the vulnerability is little more tricky.</p>
