<blockquote>
  <p>Check the home directory of flag03 and take note of the files there. 
There is a crontab that is called every couple of minutes. 
Files for this level can be found in /home/flag03.</p>
</blockquote>

<p>First, let’s check the home directory of our target <code class="highlighter-rouge">flag03</code>:</p>

<p><a href="/images/exploit_exercices_nebula_level03_1.png"><img src="/images/exploit_exercices_nebula_level03_1.png" alt="Exploit Exercises Nebula Level03" /></a></p>

<p>Ok we have an empty directory with full access and a shell script who looks like this:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
<span class="k">for </span>i <span class="k">in</span> /home/flag03/writable.d/<span class="k">*</span> ; <span class="k">do</span>
  <span class="o">(</span><span class="nb">ulimit</span> -t 5; bash -x <span class="s2">"</span><span class="nv">$i</span><span class="s2">"</span><span class="o">)</span>
  rm -f <span class="s2">"</span><span class="nv">$i</span><span class="s2">"</span>
<span class="k">done</span>
</code></pre>
</div>

<!--more-->

<p>It looks simple: it tries to execute each file in <code class="highlighter-rouge">writable.d</code> directory then delete them. 
We don’t care about <a href="http://www.lehman.cuny.edu/cgi-bin/man-cgi?ulimit+2" title="man ulimit" target="_blank">ulimit</a> here, 
it’s just used to prevent cpu overloading from malicious script (each process will be killed after 5scd). 
Note that there is no check about the owner of this famous files.</p>

<p>So we can write a little script which will execute the <code class="highlighter-rouge">getflag</code> command et output the result in a text file:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
getflag &gt; /tmp/output
</code></pre>
</div>

<p>Put it in the <code class="highlighter-rouge">writable.d</code> directory:</p>

<p><a href="/images/exploit_exercices_nebula_level03_2.png"><img src="/images/exploit_exercices_nebula_level03_2.png" alt="Exploit Exercises Nebula Level03" /></a></p>

<p>Wait a minute for the cron et voila!</p>

<p><a href="/images/exploit_exercices_nebula_level03_3.png"><img src="/images/exploit_exercices_nebula_level03_3.png" alt="Exploit Exercises Nebula Level03" /></a></p>

<p>Note: this his the easy way. 
Another solution would be to copy a shell somewhere with the suid bit, but Nebula seems to be patched to disallow suid shell so you have to write a program in another language like C.</p>
