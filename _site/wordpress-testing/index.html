<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Wordpress testing &#8211; Gwendal Le Coguic</title>
<meta name="description" content="Gwendal Le Coguic, web developer and security researcher">
<meta name="keywords" content="wordpress">

<!-- Twitter Cards --><meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://10degres.net/assets/img/header-background.jpg">
<meta name="twitter:title" content="Wordpress testing">
<meta name="twitter:description" content="Gwendal Le Coguic, web developer and security researcher">
<meta name="twitter:creator" content="@gwendallecoguic">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Wordpress testing">
<meta property="og:description" content="Gwendal Le Coguic, web developer and security researcher">
<meta property="og:url" content="http://10degres.net/wordpress-testing/">
<meta property="og:site_name" content="Gwendal Le Coguic">
<meta property="og:image" content="http://10degres.net/assets/img/header-background.jpg">


<meta name="google-site-verification" content="GnoFwHUV3XNgLy4D-7XjLQ0Dbw6fKBXZnBzMn-0GBX8">



<link rel="canonical" href="http://10degres.net/wordpress-testing/">
<link href="http://10degres.net/feed.xml" type="application/atom+xml" rel="alternate" title="Gwendal Le Coguic Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://10degres.net/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://10degres.net/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://10degres.net/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://10degres.net/favicon.png">



</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://10degres.net/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://10degres.net/assets/img/me.jpg" alt="Gwen photo" class="author-photo">
					<h4>Gwen</h4>
					<p>Web developer reconverted to security researcher, playing bug bounty sometimes :)</p>
				</li>
				<li><a href="http://10degres.net/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:g@10degres.net"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/gwendallecoguic" target="_blank"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				
				
				<li>
					<a href="https://linkedin.com/in/gwendal-le-coguic-77106729" target="_blank"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/gwen001" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://10degres.net/posts/">All Posts</a></li>
				<li><a href="http://10degres.net/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div class="entry-header">
  
  <div class="entry-image">
    <img src="http://10degres.net/assets/img/header-background.jpg" alt="Wordpress testing">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="http://10degres.net/wordpress-testing/" rel="bookmark" title="Wordpress testing">Wordpress testing</a></h1>
        
        <h2><span class="entry-date date published"><time datetime="2017-09-12T00:00:00+01:00">September 12, 2017</time></span></h2>
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>Here is the way I usually follow to test a Wordpress install.</p>

<h2 id="information-gathering">Information gathering</h2>

<p>Get basic informations with <a href="https://wpscan.org/" class="flashlink" target="_blank">WPScan</a>:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>wpscan -r --enumerate u --url http://www.example.com
</code></pre>
</div>

<p>If it can’t retrieve the user list, try to use provided script <code class="highlighter-rouge">stop_user_enumeration_bypass.rb</code>
For each user found, try to brute with basic passwords:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>wpscan -r --url http://www.example.com --wordlist /Wordlists/Passwords/best1050.txt --username &lt;username&gt;
</code></pre>
</div>

<p>If the version of Wordpress has been found, download it from the official archive directory:
<a href="https://wordpress.org/download/release-archive/" target="_blank">https://wordpress.org/download/release-archive/</a></p>

<p>Open the tested website and take a look at the source to find those strings:
<code class="highlighter-rouge">wp-content/themes</code> and <code class="highlighter-rouge">wp-content/plugins</code>
This could reveal more themes/plugins.</p>

<!--more-->

<h2 id="replication">Replication</h2>

<p>For each themes found, download them from the official archive directory:
<a href="https://wordpress.org/themes/" target="_blank">https://wordpress.org/themes/</a><br />
Try to download the exact same version from the SVN repository (ex: <a href="https://themes.svn.wordpress.org/matala/" target="_blank">https://themes.svn.wordpress.org/matala/</a>)<br />
If you can’t find it, try to download the version before and after.
If the theme can’t be found or if it’s not free, try to find it from Google or on some illegal website (take care of backdoors).</p>

<p>For each plugins found, download them from the official archive directory:
<a href="https://wordpress.org/plugins/" target="_blank">https://wordpress.org/plugins/</a><br />
Try to download the exact same version from the Trac browser (ex: <a href="https://plugins.trac.wordpress.org/browser/anual-archive/" target="_blank">https://themes.svn.wordpress.org/matala/</a>)<br />
If you can’t find it, try to download the version before and after.
If the plugin can’t be found or if it’s not free, try to find it from Google or on some illegal website (take care of backdoors).</p>

<p>Once you have everything, open you local dashboard of your local install, and enable all themes and plugins you have downloaded.</p>

<h2 id="find-an-exploit-the-easy-way">Find an exploit, the easy way</h2>

<p>For each themes and plugins found, check on <a href="https://www.exploit-db.com/" class="flashlink" target="_blank">Exploit Database</a> if there is an existing exploit:<br />
<a href="/images/wordpress-exploitdb.png"><img src="/images/wordpress-exploitdb.png" alt="wordpress exploitdb" /></a><br />
If yes, try them all.</p>

<h2 id="low-hanging-fruits">Low hanging fruits</h2>

<p>Open a terminal and find all files you’ve got with the themes and the plugins:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>find &lt;your_install_path&gt;/wp-content/themes/ -type f
find &lt;your_install_path&gt;/wp-content/plugins/ -type f
</code></pre>
</div>
<p>Save the result in a file and inject in Burp Intruder on your target. Check the response code, this will give you a good idea if you have downloaded the right things or not (you should get a lot of 200).</p>

<p>Check twice the result of PHP files, this could reveal a Full Path Disclosure:
<a href="/images/wordpress-fpd.png"><img src="/images/wordpress-fpd.png" alt="wordpress full path disclosure" /></a></p>

<p>If you don’t get anything, retry with all PHP files, even the Wordpress core.
Most of the time WPScan will detect it but it’s worth the hit to try!</p>
<div class="highlighter-rouge"><pre class="highlight"><code>find &lt;your_install_path&gt; -type f -name "*.php"
</code></pre>
</div>

<h2 id="code-analysis">Code analysis</h2>

<p>Time to dig deeper! For each themes/plugins, use regexp to locate dangerous functions.
Test everything on your local install before testing your target.</p>

<p>SQL statements:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>egrep -ri 'select|insert|update|delete' . | grep -i ".php" | egrep -i "select.*FROM|insert.*INTO|update.*SET|delete.*FROM"
egrep -ri '\-&gt;prepare' . | grep -i ".php" | egrep -i '\-&gt;prepare'
egrep -ri '\$_SERVER|\$_REQUEST|\$_GET|\$_POST|\$_COOKIE' . | grep -i ".php" | egrep -i '\$_SERVER\[|\$_REQUEST\[|\$_GET\[|\$_POST\[|\$_COOKIE\['
</code></pre>
</div>

<p>File system interaction:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>egrep -ri 'fopen|file_get_contents|file_put_contents|fread|fwrite' . | grep -i ".php" | egrep -i "fopen\s*\(|file_get_contents\s*\(|file_put_contents\s*\(|fread\s*\(|fwrite\s*\("
</code></pre>
</div>

<p>Command execution:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>egrep -ri 'eval|system|exec|passthru' . | grep -i ".php" | egrep -i "eval\s*\(|system\s*\(|exec\s*\(|passthru\s*\("
egrep -ri 'assert|create_function|preg_replace' . | grep -i ".php" | egrep -i "assert\s*\(|create_function\s*\(|preg_replace\s*\("
</code></pre>
</div>

<p>File inclusion:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>egrep -ri 'include|require' . | grep -i ".php" | egrep -i "include\s*\(|include_once\s*\(|require\s*\(|require_once\s*\("
</code></pre>
</div>

<p>Custom headers:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>egrep -ri 'header|setcookie|content-disposition' . | grep -i ".php" | egrep -i "header\s*\(|setcookie\s*\(|content-disposition\s*\("
</code></pre>
</div>

<h2 id="boring-stuff">Boring stuff</h2>

<p>Finally, you can use the same technics you use on other website. Try to find endpoints from Google, Wayback Machine, etc… and test SQLi, XSS and so on…
Far from exhaustive, you also need to check authentication deeper, specially if oauth is part of the party.</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="http://10degres.net/tags/#wordpress" title="Pages tagged wordpress" class="tag"><span class="term">wordpress</span></a></span>
        
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://10degres.net/wordpress-testing/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://10degres.net/wordpress-testing/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=http://10degres.net/wordpress-testing/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
    <div class="see-also">
	<div class="see-also-header">
		<a href="javascript:;" class="see-also-btn">See Also</a>
	</div><!-- /.see-also-header -->
	<article>
		<ul>
			
				
					<li class="entry-title"><a href="https://hackerone.com/reports/136169" target="_blank">OneLogin authentication bypass on WordPress sites</a></li>
				
			
				
					<li class="entry-title"><a href="http://local.10degres.net:4000/image-gallery-sql-injection/" target="_blank">Image Gallery SQL Injection</a></li>
				
			
		</ul>
	</article>
</div><!-- /.see-also -->

    

<div class="read-more">
  
    <div class="read-more-header">
      <a href="javascript:;" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="http://10degres.net/subdomain-enumeration/" title="Subdomain enumeration">Subdomain enumeration</a></h3>
      <p>A friend recently asked me what methods I use to find subdomains.To be honest I was confused, like *"oooohhh so much, brute force mmm... ...&hellip; <a href="http://10degres.net/subdomain-enumeration/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
	  <div class="list-item">
		  
			<h4><a href="/ctf-h1-212/">&laquo; Fail at CTF h1-212 - The Evil Job</a></h4>
			<span>Published on November 20, 2017</span>
		  
	  </div><!-- /.list-item -->
	  <div class="list-item">
		
			<h4><a href="/kick-the-bucket/">Kick the bucket &raquo; </a></h4>
			<span>Published on August 01, 2017</span>
		
	  </div><!-- /.list-item -->
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->

  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2018 Gwendal Le Coguic</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://10degres.net/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://10degres.net/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61485350-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>




	        

</body>
</html>
